#include <assert.h>

#include "rdtsc.h"

#include "../ec_bls509_lcl.h"

#define N 100
#define M 10

//============================================
//   Feature of Field
//============================================
void test_feature(Field f)
{
    fprintf(stdout, "---\n");
    fprintf(stdout, "FieldType: %s\n", field_get_name(f));
    gmp_fprintf(stdout, "   characteristic: %Zx\n", *field_get_char(f));
    gmp_fprintf(stdout, "   order of field: %Zx^%d\n", *field_get_char(f), field_get_degree(f));
    fprintf(stdout, "---\n");
}

//============================================
//   test for arithmetic operations
//============================================
void test_arithmetic_operation(Field f)
{
    int i;
    unsigned long long int t1, t2;
    Element a, b, c, d;
    Element d1, d2;
    Element g1, g2, g3;
    Element h1, h2, h3;

    mpz_t exp;

    //--------------------
    //  init
    //--------------------
    element_init(a, f);
    element_init(b, f);
    element_init(c, f);
    element_init(d, f);

    element_init(d1, f->base);
    element_init(d2, f->base);

    element_init(g1, f->base->base);
    element_init(g2, f->base->base);
    element_init(g3, f->base->base);

    element_init(h1, f->base->base);
    element_init(h2, f->base->base);
    element_init(h3, f->base->base);

    //--------------------
    //  add
    //--------------------
    element_set_str(a, "966B1BFA021D2D2D22FFB0CEB2B420870DA9587234E35D976B8B431A87EF666B9752B8AC3AD9840AC8501874218F19AC533A518996F0573C387E245358916FC 8F01621D97F5967D0CAEA957472E0CA395CDC59CDF7B87C3F63C082220DF73E67FA3AC12267FD634633341D484BC167ACDF232EFB25389C1DE8D612DDF0F19 12B5DE491F74D881D8FFDDD8979F557F7602081AF83DFC28CF7BE6D7461B5034A1197C1E1AF3F0BEBEC34DA72936D4D4CF24EBCFC6E78856D7BBDAF4E85AF0E0 1F8B7F63C59535C610EBF42BA11DBDEDC5F665F0189C4C260EFDFF5576995E639D05F9655CA8CA86A96B61F9B4B2F4C385E2AE00C22A9D8263AF2FFE9719801 47697F72CD2F4AC188353AF7E47AB3902ACDE35E25FE69C3C1BD22292BD3B12F7100C1D710892FC3AFCF18651EB05D6DDACF3D3D2E8489C92CE0B7CB448CC71 DB394FA66C06D0D33939384841E66D079F67075BD8CEF279AE3D8DF7B031C008542303D1B5D057FEEEC8BA1ABEBBB7B25FA48EF86C0AB96AB63D068D110480C 1370B45D7A9EF083D4DEEAD7E369FADFE92D227A4E34F87EA051FC27658A9C71E4F436B870313678D2A7E7132423A4667BF401020E52643F4E3E84AD33CC6474 7403DF2CA21CDE5F80373E1690C03BC0B2A3062F65808A95B0EB3BA2D1C7E8A7B0BDA4D32325D1296065C57C5E412CB4A27235897FCC9468D67E4CE7344F659 13135249C4A8CD65901D6D7D0669F3A26F2E1464905B5F6DBD5E1F074E88B1381EBDEE588BCF1C852E6E4610123F852FABE5906F06A74E22A27FFDD90556302B D3DC4A9E35C0C5BC6B35A082D91C0CD10B957566B4E1521C53229C4561C680ADC31720DE175BAF796529C4AE250FBD6ADC6FB18C650D1E6BC1795D761C877E9 A89B84AA8136B23E597C677C25E042E15DD01129F2B44B24BA93E315843090AB160220B45C4457B3E1E012D7555CECB65FA3FABABEB8C366BD5B3FF9CFB030B 8F63DA2F8B22BD78702265302F8BF0D295AFA8FB2684CE26548BFC3A9726BDE09D49C7D32A70E1FEF7DF73CAD454CDD45B940B042FD1F7855F93B84E9CCD746 AE2BC9B4718B17882043D58D9CAFD62EF0175F3FAA034F51A32C2BE519584120B14435D070391FA08F53EFA472208C0D1A424870CFCE7444FF4469143970004 52344900DFEFCF22B725B98CF962B9AA7C55F26D3512B122DF8E22686C1E198519C07759E86434CEC1BEF95D22F02AD9519E360E51B517B8FCBF0CFDA8A6054 2C8B270071AB5F9307202EA68A940DB11A29858A7F22387053126BC15F32751EBD030D9E7D584B34FC0C0B7B422B34547B5753CE66E71FB21E217E7E6A24416 A95BF9C35ADE6D9A285B6D50689AD6FF1727407710BA2536E421105B16FE9CE43C0DDF44D4644EF4DE967EBDE3E4B2177B55BB22D78D48784564A4F2E3A70B5 2F859F3C09A38CD3A054B62863D56547BC763A7372781FF3430C02B43E6FE9052CEACC26AB7E4119E78087A2EDB62940869A7FE4C0DD58F0A3637A02B6B56FC 1080EF6AE3A0A0F4D79C32989C526EB720D5718A94FAC4C00B86DE38556EDEAD7EA93711D3A014D46DCC7C8B1FC32C07525483F23CE48C64E0B838CDB3D0D543 1092D9746712503BB0AE87E13C795111A93E80D7E784B280B1CFF7811BAD475FD031B1D6F9CB595DAF327DE73F05A34A14DA3A3B8A089098323B38311A4E6061 12382682A808058567B00BE95F31E174B1319E5D9A46821E7121233DF5975764A70C6677D04AF366EEE69070A178EC45B9BDEE76FB41C5AFE46124300D06E65B 69A80260BF5E41189B31FAE9F87A3C17AA2C76429CC013306E0F9C0C5CA74E68344FCD76C20C2E3684390756C99CFB36EEA75E78F2C7E6D9A234370818AFC02 F8759AC410001A5BA27D963C045845B9E3D30ABB55EED84FAA5FFCB447FADBA22739DF7770F070626DD1849CBBC6F676EF2629E433A46BF7FC67E65804CAB28 D525930733A573C23CDF85AB4055488F5B007D5E36D16FC60E555C77FF12465B6452EDB47187B90059628ACA545BF44BE76B20780995A0D24962AF5D6B04439 3B4111C7F5A72682AEDE579B378FE129FFFCD7CC52281F54783FBB72694C1D88E6E8AEB9AE376F91EB207A391D245CE2C9F5FC24A6ECA5BADACD994B1726613");
    element_set_str(b, "4ED54A10EBEFD95916304E1C3947741055BC3EDDAA701A3B5224DBBCF620F1B57DDACB5BBB1C0B7ABAE00D5C88E38D59630B23AECAF08883C4BDD32871027FA 1481C798D3F9A5C941E2172A6E93787DE71AA67B04616D3F95355ED4312484600CA243BC4EACC7924D0C6F4EA25103794125D0AEA50080FAEED1BCFB21D2CD7E CA6C6E990E4C8E4B0D823A1BBC533AB6049D93A9D3E34F7BB5356DF0F0C7D5C0E2BC60B94DD23C22131CA9FBE511EB2F11241A674C6ED14DD9A4F78F9BCD060 B4CFA9328021BD934E0A000AE76BCC1AB776FF1EA2E6CA7FF2F614B206F181C9C87E69335509F1211D49E377E05093F525D13E594C55B1F50C305BF1272F33C 615AB6C6AA4DAF4F8EA9FEC99EAD747794CBCE195266D7E721D6918362DFC93AADD88D93539292D33E0281351039CF58B29BF034362A5E9E15BB528A6E3324E D817E55BEF76B38F546A6B0A51AECB3C143F7C5420574ACCC314666D12E7CE49385C96B3748CFC05FC8FFB630753C1D3AB47F1ED4CFF6B202F1EC8251F7EE06 B588783DB165E76879FCA9D9ED7EEAEBB109CD60A1EEE85DE25BD146F2E044A2AB147261A1BB8307842A32FB8A7B77B8B9D6FB1945F7641CCB053D06D5C638C DC13E02618B8F69EE56286ED5932973666A309AD7634486172A540B189918725F286741677DA9B52563C0A1371784C681BD868F19D8D64B261975E8B59CA6F B48A277DDA4C9E7ADACC57D0FC046CDF3FD434083EDE953963C1580863AC53376786662A65A8EF5E1FA3069CC01E6FB70961DC2016036FD9729410CD76DC685 13E155DDB70B69457C417D3257FD8D690420BF2B3F3745A0C9927FEB75423BE106F63653B243A7920F92CA01F9CA55F993AB4C4965D1067B9B2B39F00FD4A34F 173F333FE0066B7BCC278B47AEFF1B3518E0ED026388AD52B98E846A40F97D7966A7C1463D890461B116C3B5DCF46B79A99F5FBFC839B751ECC2E82F938B82C B980D6BC2B755BE1055D2C2939F424851075A7BC4486E13269AEA55AFDE14ED9304494280B6E41A64C4A265D667B0123CE91BBAE6289D5CB648608EF7EA39D2 140038BF0CFF20EADC74EAC31D92FF6F69498473FD841ED22F2E2C86FB39B75206EEC7B3573DB4BBEA273248713C5D81F7F29E11E550DD8A29EA16DCA88F5ABA 12D39B907ACDD134A2626A42BAF6EA0624D057B769BFCD0FA39C396EBAB3F5C86EA7A5A69D933D645D0ACD8715B66A68EDBEF67CC4DF6003289F1E7876393B04 788FF3BD36F6AC10FE82928B2D26C310237FAE927B7F824A881E5984E75DDEB7F01A0205CD0E51BD4355A681BDEF25728F1077687B8075D4BB39A25B2F6FEBD 6C5EF4F2EF9AC8D72EE4556E9A50FC9C3F43CD55ADB817F6B917AEA65B2CA3F61DBC94DA75AAA48A64C924D62D3B0ADB23CBC78274E5674AE9D32E2FF5DA5E8 15914DB9AE5B67C3559C4B26EDBCFA70D9BE32E3BA66382837718428C6B8D3750DDC408AD6C8BC1DD2789E6B27408C7CF05DDCD9D79C8489AC829CE755DFC02 401A55EE566FFE2D90BF92C99728C93A3B2DC79A9CB1A482F30613202685941AE63F3043FA625C5CAFBC82CF22B672FCBB4542B08F7D329EB0E55B2577421BE 120E61382DB69641D56FC1B81724D554E6225FC7A03D7E933FFE6962BF89DCD4028E417B1BC74A2C735171CDD77DE416D3543D36307355F7A94F01594EFDED91 103789397AC3B36545326BAFBD3A590C097127A5CBCE2EE5DE479BBE5B91AE73BE67DF100764E8C7B50479752A61378F10563FCFBFF625A810D0E8520F256373 A34F9DBDE34B522C35566817228C421017B1BAA699D63241F8CE3FE9EB150589369C40BCCA9FB605E2271F6D0DE2AC4A11B0294A4A8B4B12191035B9BF8F04C 1446547B13F0E745AE4BFC66EA94867563A6BF05C63878FB90C456A19174524A31CE66581EF779481D84B453CFEF2F38D52E9777ED8D533D1AA402D7307524D7 1371A6050F552A3D996BA27DBB222D16E11213BE32E0B1B3683210637EAB3249D456782CF34B6DBF14894B10610C8E9C47C15EEBA0A541D01214CDF09D95098F 11CE79220A3EB2827B0CE23712CC7EA057A0709322E6099BA9987C4186C2DDDB44C95D69D47804924A638A83B7BD7C922B94F9429A8AFE90EBA4E38460A7D417");
    element_set_str(d, "E540660AEE0D0686392FFEEAEBFB94976365974FDF5377D2BDB01ED77E105821152D8407F5F58F85833025D0AA72A705B645753861E0DFBFFD3BF77BC993EF6 1510C8FAF1919B5FBEEEC5D3C5DAA68A8AB07440A140E8C7592B9ADC534563D3F321E76860D34768816FA29076D5BF8FBBF3C2E194B2D484B0B04A5C4FB1DC97 A074E32B11FD6CA8CEA0EC559A39C340AC1190C3863B29457E53CB275173CD54CD6BC6A33B873901029BBE675CD1FB4D1D3706ECD20E26B141918E02957EE95 D45B289645B6F3595EF5F43688898A087D6D650EBB8316A601F414077D8AE02D65846298B1B2BBA7C6B54571950388B8ABB3EC5A0E804F776FDF8BEFBE48B3D A8C43639777CFA1116DF39C183282807BF99B177786541AAE393B3AC8EB37A6A1ED94F6A641BC296EDD1999A2EEA2CC68D6B2D7164AEE867429C0A55B2BFEBF 5DFBC50267E0DAA2BEC47802F78668D6FAF9FF1A279E548342B1E426C210829B65973E8D68D344F7EEA2EF76AA623C5724B0B06ED030F480D18AB5D6A486367 973E4E1567B845E5F90C2C08880FC97D8B2F706FB3B68784B8DB837F4A81000AD36F81F0E344DB87B1F2DE26B10880F192DB3AC3424478079B1C6EFE868F555 81C51D2F03A86DC96E8D668566536534190D36CA3CE3CF1BC8158FADEA61011A0FE60C148AA37ADE85C9861D9558B17B242FBC1899A56AB3FC97C2CFE9EC0C8 9069DC1A313CCB140DC40451C694D7997A08F5BB730CA3520B03383F4B2E5B032C7CEFBB6110A8A409D1A196C8698582E17F1299979F21F986C2D5824042405 BC9C3879B2DAB054606E4858BCE613F494F4E384D6CDC365BDAA8ABEB4E133080B922A217A0C198D61A09EC6A607DFD530E8A5ABD944561B605BE39B8DD488D BFDAB7EA613D1DBA25A3F2C3D4DF5E1676B0FE2C563CF8777422677FC52A0E247CA9E1FA99CD5C1592F6D68D3251583009435A7A86F27AB8AA1E2829633BB37 148E4B0EBB6981959757F915969801557A62550B76B0BAF58BE3AA19595080CB9CD8E5BFB35DF23A544299A283ACFCEF82A25C6B2925BCD50C419C13E1B71118 98D9E5A54DE07C7618B3566FD9D0FDB8CC0321E9B0BD53B1676EE416CBEAAA8AF948550E228A5C5235114E246A3926FDB33059183C031CDD8A14BE033668813 2A189208993038AD0E6D32690CC28AA010AEE94DFF879959EAB1A91616546A55DD5275CC000DFC0795B60BC762A994394751CD63B6D1E7E172DFDBA9803C8AD A51B1ABDA8A20BA405A2C131B7BAD0C13DA9341CFAA1BABADB30C546469053D6AD1D0FA44A669CF23F61B1FD001A59C70A67CB36E2679586D95B20D999942D3 115BAEEB64A793671573FC2BF02EBD39B566B0DCCBE723D2D9D38BF01722B40DA59CA741F4A0EF37F435FA394111FBCF29F2182A54C72AFC32F37D322D98169D 4516ECF5B7FEF496F5F1014F51925FB896346D572CDE581B7A7D86DD0528BC7A3AC70CB18246FD37B9F9260E14F6B5BD76F85CBE9879DD7A4FE616EA0C952FE 148294C9C907A0D7B0A82BC535C4FB4AC4884E043EC5DF083AB73F6A57D737EF2D0D2A1613463A9A38C844B811EE93371E08D81D45DC5F8ECBC68E800B44F701 D4BE3AC958F1BE1893056E459DD396FC3D618562AA9B287BEE45FDFFB26937870516D92997A029952B89354A4C8B38DF9CABA6A4BEE538F3A4D27FCB08C7B47 D1A58BC2391EE4EAFF484E422AB4D89EF17FDBA08FC32781C7EBDF87118751D0305BFC85B973B3DD41FAD855A1F5001DBB0713F4CAA585753F4FAF4636C7723 10CF7A01EA2A99344D08863011B067E27C1DE30E93696457266DDDBF647BC53F16AEC0E338CABE43C666026C3D77FA781005787C33D5331EBBB446CC1D83EC4E E78572755B71E4F6B85E315B1191DDA365927681E7EE7F458805568F5E36F48F1D37E9019EDDF5D7496703D29F0CACD55BD3D0EC23A06FBF92D6FAEF801FD54 B6EA8358355B6DDC04BA823756694A90B37534AB9354A23962D65271E8BC5F4282D2148BE4B485E4A54175C94977A0E17D453EBB2B108DC956DE758BB857B1D 2D333E8A5F5A4EA90CD4FBCC848FBC2C1575C68AF00D04BE3276F4CD470EF870C96295F342DA9A994A35C6D7D4EE8D69D09BFD766C35EBF814AB8B595A677F");

    element_add(c, a, b);

    assert(element_cmp(c, d) == 0);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_add(c, a, b);
    }
    t2 = rdtsc();

    printf("element add: %.2lf [clock]\n", (double)(t2 - t1) / N);

    //--------------------
    //  sub
    //--------------------
    element_set(d, c);
    element_sub(c, c, d);

    assert(element_is_zero(c));

    //--------------------
    //  mul
    //--------------------
    element_mul(c, a, b);

    // element_set_str(d, "B4BFA10A9B884056B04DCFACFFD63584819F1096BA2E1A2BBBC264298DB9F8BDA8A52822F9C2994E39E066FFE410C01E17866F750A7F0369FB7CD66DF46D18A C7499B150218506A1D15D530247DB716A9F9976449E20B07FC821C016D1042A8A817335C17F04BD75A33CCAC2E4ECAA577892A04EBE1710F12FEF1216FC8145 A4BF62930D934723AC4A715B6047FA2A31D017D371E33723AD6F7476BDD2A8C89C5AC4F425AC903D977513CA040DDCE9FE78CFD3DB32885435693360D4E2C94 587C31B875F18978ED78A14614C074E079355E9B496CB8F68E62613DE1511ED3D38E9DF6D00B66D8D40BA8BAFD360EF06B9FCA97F74022CBBAA3FF849D1CCB6 B2B3519EB562FE797DCFA77A70443E85A3465E8C56B5AE566E635D6A24B2B852D247214E9258BB2FF4FA9FC8CDF21ED6361A6757756FC523CDB0CBAC8C0F73F 36747B7307E67382C35E5B9126CEA8549C8EA0E03437786C769292B40707D0AA324397312F424F971C439A939FC49BD6209F585E3311CFD2D8F36898CF887DB A63BA2815124CA732769D517EFA25BD68B2A1910F0C82F4C62920EA6BDA49F0A7D35721F0D1F8D309A4386BFC8A40D53F577EFFA31D59AC635BDF94DC89C169 2FF35251A1D102376F898DCFDF6EC4FCAEE1A1AFD13D919BECE7B606DB2ECFAD1042BC315DDDDC7F80501006B5FF5EB0A14CF4A5A90898364B1711EC226CA38 E6B68643F4011938BA0524B84E3C64CF8155DC0F3CF624CC26F8EE788907354957E89E9841DAF31D02B1E4F563CB5BE7DCC5E1827AF660AF70CE3B677C1140E C18E629EA5558A4DEB0904E8B3FA84A061A87071E96BA93C88899C4AD0800675DBFC09A16A4EEDA8769BFCBCAE5D46106429B3CB7855F17F187F8EBDA5B7354 124C74D3FA6F5C62EA102AFB96A4B79BB5A3FC9833AA3080C89DD0B6496D37F9A845FB1D8086A762B1506156A7B8E92E866B3743EFAF16464E7A5F618CEC87E4 3AE998455AAA0FB1DA9AF4730F90DC44A69261FE9DEBD7B9362F1216E297D036944355DF41E4324E542FFF222B5C75920B899FF50C4FF42E000A4E79024962 12CED60A86AC6950D9FB2E2BC092A79D51AAE7387F2C0715FA3A0F9942CB6AF94CBABB55EE17E210279678811135E3CB7589AF6BD65D4C10DEA26109320FF12B 918ABE0C9535CF7BDDFEA3B6410C6368B38344C7F2D17B8F3F88771EC8DAEA9128C10150209C4AB4B795BEBEEBA2E133A5F0F4C54B17B3CE4B8528E3DE7CA40 3EB898910B68A7B46ED0C61887A0A671DDFD7D8B1DC26C092A0D76E69EE628934C66FB99B336C2F94D548E1F608572563A74F76896CC9D208745D2CD5AC7241 6236A188A4636EF2EE2BAC5638EA0AD18BE771183F6DD140FEC0B08C14B342983E8DBE58376D2479D4258FFA02CE5E6BB9E2AAC8615B63E970286FCA90CE541 126C528EC638880B3171C2EFCCBD1E97E2FBFE70A6F1760C530208D4337678A534DB3B5C5B1F4CAF4A55717DE955D19508A59C9376A2500D40B153532E93240A F4194DFDF76D9E2F0890D6F9EAD357CA05DEF7DC741E07B441CA644DA8005EBB7AA94DACD315D839DF7B2CCEB46349EC558B0E8E24BECE129AB33AD482C1ABC B6FF67D32AC0EB8443BE00C7E7723B225AE5A841FD3461F4C369BC7BAFFB4A27F41B4EEECFE36C5BCC16D892F8EE85A719CD225613F705D54F29D224E4A6730 66CA5B8B8320DC33F14E54DBFA9CBE50B5722F0E70E0E0FB738D365927982E387560565B71E35417AFE850F68D01378573BD67FBB33EBD0A528F4208A0BD095 FE760B69C06B543540537FCCFA65E2A00B09869D8A0DF82606BDB56EB2F47ED8274A1BFB81DC0A3D2C24C82A70F407521AD0B4928CA952299DA70E512088228 115C0CBF91E2FA0072218590BFFB7559B9105ACDD91C6C9B17CD88E9703B2AD4C252B2718B99640103513F79D76EFB1A9261E496F76686B3F60FB7876038B01D 518ADD9ADD5568F459F5AD81CDE13AF657067E509CB99A61D99FFCBD3A2A58E433A82E91BA42976BDB3AEAD965776394B5080C573B948353C701F81CFF06598 FA740C56F5346F7CC65ADE12AD733A7CC8D35398A8E4DA7CD4F9E7808E7E7936E66F5F6E0B4D7F1A8A903FA2399D8AEA3593275B89EDC89246C29426760D444");

    element_set_str(g1, "B4BFA10A9B884056B04DCFACFFD63584819F1096BA2E1A2BBBC264298DB9F8BDA8A52822F9C2994E39E066FFE410C01E17866F750A7F0369FB7CD66DF46D18A A4BF62930D934723AC4A715B6047FA2A31D017D371E33723AD6F7476BDD2A8C89C5AC4F425AC903D977513CA040DDCE9FE78CFD3DB32885435693360D4E2C94 C7499B150218506A1D15D530247DB716A9F9976449E20B07FC821C016D1042A8A817335C17F04BD75A33CCAC2E4ECAA577892A04EBE1710F12FEF1216FC8145 587C31B875F18978ED78A14614C074E079355E9B496CB8F68E62613DE1511ED3D38E9DF6D00B66D8D40BA8BAFD360EF06B9FCA97F74022CBBAA3FF849D1CCB6");
    element_set_str(g2, "B2B3519EB562FE797DCFA77A70443E85A3465E8C56B5AE566E635D6A24B2B852D247214E9258BB2FF4FA9FC8CDF21ED6361A6757756FC523CDB0CBAC8C0F73F A63BA2815124CA732769D517EFA25BD68B2A1910F0C82F4C62920EA6BDA49F0A7D35721F0D1F8D309A4386BFC8A40D53F577EFFA31D59AC635BDF94DC89C169 36747B7307E67382C35E5B9126CEA8549C8EA0E03437786C769292B40707D0AA324397312F424F971C439A939FC49BD6209F585E3311CFD2D8F36898CF887DB 2FF35251A1D102376F898DCFDF6EC4FCAEE1A1AFD13D919BECE7B606DB2ECFAD1042BC315DDDDC7F80501006B5FF5EB0A14CF4A5A90898364B1711EC226CA38");
    element_set_str(g3, "E6B68643F4011938BA0524B84E3C64CF8155DC0F3CF624CC26F8EE788907354957E89E9841DAF31D02B1E4F563CB5BE7DCC5E1827AF660AF70CE3B677C1140E 124C74D3FA6F5C62EA102AFB96A4B79BB5A3FC9833AA3080C89DD0B6496D37F9A845FB1D8086A762B1506156A7B8E92E866B3743EFAF16464E7A5F618CEC87E4 C18E629EA5558A4DEB0904E8B3FA84A061A87071E96BA93C88899C4AD0800675DBFC09A16A4EEDA8769BFCBCAE5D46106429B3CB7855F17F187F8EBDA5B7354 3AE998455AAA0FB1DA9AF4730F90DC44A69261FE9DEBD7B9362F1216E297D036944355DF41E4324E542FFF222B5C75920B899FF50C4FF42E000A4E79024962");

    element_set_str(h1, "12CED60A86AC6950D9FB2E2BC092A79D51AAE7387F2C0715FA3A0F9942CB6AF94CBABB55EE17E210279678811135E3CB7589AF6BD65D4C10DEA26109320FF12B 3EB898910B68A7B46ED0C61887A0A671DDFD7D8B1DC26C092A0D76E69EE628934C66FB99B336C2F94D548E1F608572563A74F76896CC9D208745D2CD5AC7241 918ABE0C9535CF7BDDFEA3B6410C6368B38344C7F2D17B8F3F88771EC8DAEA9128C10150209C4AB4B795BEBEEBA2E133A5F0F4C54B17B3CE4B8528E3DE7CA40 6236A188A4636EF2EE2BAC5638EA0AD18BE771183F6DD140FEC0B08C14B342983E8DBE58376D2479D4258FFA02CE5E6BB9E2AAC8615B63E970286FCA90CE541");
    element_set_str(h2, "126C528EC638880B3171C2EFCCBD1E97E2FBFE70A6F1760C530208D4337678A534DB3B5C5B1F4CAF4A55717DE955D19508A59C9376A2500D40B153532E93240A B6FF67D32AC0EB8443BE00C7E7723B225AE5A841FD3461F4C369BC7BAFFB4A27F41B4EEECFE36C5BCC16D892F8EE85A719CD225613F705D54F29D224E4A6730 F4194DFDF76D9E2F0890D6F9EAD357CA05DEF7DC741E07B441CA644DA8005EBB7AA94DACD315D839DF7B2CCEB46349EC558B0E8E24BECE129AB33AD482C1ABC 66CA5B8B8320DC33F14E54DBFA9CBE50B5722F0E70E0E0FB738D365927982E387560565B71E35417AFE850F68D01378573BD67FBB33EBD0A528F4208A0BD095");
    element_set_str(h3, "FE760B69C06B543540537FCCFA65E2A00B09869D8A0DF82606BDB56EB2F47ED8274A1BFB81DC0A3D2C24C82A70F407521AD0B4928CA952299DA70E512088228 518ADD9ADD5568F459F5AD81CDE13AF657067E509CB99A61D99FFCBD3A2A58E433A82E91BA42976BDB3AEAD965776394B5080C573B948353C701F81CFF06598 115C0CBF91E2FA0072218590BFFB7559B9105ACDD91C6C9B17CD88E9703B2AD4C252B2718B99640103513F79D76EFB1A9261E496F76686B3F60FB7876038B01D FA740C56F5346F7CC65ADE12AD733A7CC8D35398A8E4DA7CD4F9E7808E7E7936E66F5F6E0B4D7F1A8A903FA2399D8AEA3593275B89EDC89246C29426760D444");

    element_set(((Element *)d1->data)[0], g1);
    element_set(((Element *)d1->data)[1], g2);
    element_set(((Element *)d1->data)[2], g3);

    element_set(((Element *)d2->data)[0], h1);
    element_set(((Element *)d2->data)[1], h2);
    element_set(((Element *)d2->data)[2], h3);

    element_set(((Element *)d->data)[0], d1);
    element_set(((Element *)d->data)[1], d2);

    assert(element_cmp(c, d) == 0);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_mul(c, a, b);
    }
    t2 = rdtsc();

    printf("element mul: %.2lf [clock]\n", (double)(t2 - t1) / N);

    //--------------------
    //  sqr
    //--------------------
    element_sqr(c, a);
    element_mul(d, a, a);

    assert(element_cmp(c, d) == 0);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_sqr(c, a);
    }
    t2 = rdtsc();

    printf("element sqr: %.2lf [clock]\n", (double)(t2 - t1) / N);

    //--------------------
    //  random
    //--------------------
    element_random(b);

    //--------------------
    //  inv
    //--------------------
    element_mul(c, a, b);
    element_inv(b, b);
    element_mul(c, c, b);
    element_inv(d, a);
    element_mul(d, a, d);

    assert(element_cmp(c, a) == 0);
    assert(element_is_one(d));

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_inv(c, a);
    }
    t2 = rdtsc();

    printf("element inv: %.2lf [clock]\n", (double)(t2 - t1) / N);

    //--------------------
    //  pow
    //--------------------
    mpz_init(exp);

    mpz_set_str(exp, "103DC9103A8BDD2D08BA8E58EC4AD8AA108177A04CFBBAE6FB7CE07A88E298C3", 16);

    element_pow(c, a, exp);
    element_set_str(d, "4055F73B4A988C8A177BD21912BA99773744EC4342A7AFFD553F482954614087ED371E4E06184F19C1C71AA6C5E75C9AE2472BBC3B1C309AD4D294F29FF2C8D 113186888483D08807C473EB16BC3B073178659727D858C1C325C56F012C89D034F17AB2BB451B51445D06C8B72EC3E258F7B99BB36CB26EBC2E627EE98BE5BC 7618A87D65B0140A0E8A074009EFFAF370AF842014600ED3FA9A01F1AC5B97B6AEB2A96EACDF9F760D282C6C686F6FEF212594B7F055A8DA190EDBFCF83B146 319013BAE3569DAA15B45A7E464B7680953A84E9EF678F4FB1307AB8101E620F0787797FDACB10CB0E500981B65944C13B77A49E5632DDA273D73FAAF8285D9 135A116081B36ED50B8E07515C633D14F21AFDEA89D2C5C5886CF038A807B400E3FBC9AE1804BB0FCA4739644FB96BE1385F8E65F6C283A94D33C5FB17265C7 F085C801805F8FB2469FE641AB6EBB4122D688CEBFE5BF51AF31ED3B120AC03523B0D06193F6F191B7C5616646832B3D4FE208482C261258969C7127A609BBD 13784C2C989FB7EF5039BD6402BBD6C88D25183943CF3467140E3C8E2865E173AA4D4E42DF64367B50BA1386DE4825591BC3DF87857F32353BCE51D114AA7963 4D0A943693AD49F7AE51BD761319C9C009E6D9CD60D6C38EF26456166CCD0F8109D95A3B26FB64F11004031CE79AD7DAC4F5A18C42286FCFBC489BC0DFD459E 76D505FFD674385BAFB4C206F7B5FDB06616BA7B8B86AD539E3A601199CC58D1056B4DF6C19180C7FD80A9D05D8C43214F5E49C02DA4CEC14D8956848AAE20 3F0563D354F0964E12506E774344036C6BB14894D16182D6E1DF3E3BD81C1AA803243858D6A63B35B97F751D2968E183DFB16BF9A275B142B17230C7CEDA9BB 1430F288B031BF25A0D2960BC1F7EB8C52C3CA08E89AA6BC7DA72796A98BD0B29DA681158E953361E7984A71EEAFB93F36AC2DE9538497749877C12927AE8230 C204D1AA8BBB812F694C98C6EE142FC60855B5E42FC91F98FC7E45EF418547D8E0A1EFE785B54C59B867DCFD49AA7706A81ABAEE7B051550A24FC6DACCDCF0A 67B077AB714067B95CD03122867C7A4E0BA11E491D6BAA7C4692FCAFFBCCC489DBF3E941214F127737EBF4963A00251188ABC92868A2CF7A0F6F4C86F69D1B5 1326931DE9D790191B6E1DC1278DAC1ACBB20C3CD0D63199A1C5FB6F4F95CF444A1059BE079DAF296B2EB13DFD055EF9875CEF292FC5EDC5715900B51F1D5F2F E4BEC42167F27B07395073E506447BEBFECC48FB607016F962358AF9DEB0998FC20B22DD4A8F1B883476D69E86046C629C68B0C937920C4BF19DE2112B6A151 C703389383B59AB7535B3C2E544A06B7CFD0D7DCC90CB99FB80B99FCBF35106E8062ABDB4E0612A24B8D0C8CAD434737A985987FEBDEA7FC6143EFAABF43E6B EA5C154CFA8C5EC89985887B69AAFC6EFB7201F587C40823FA9F72F9BAA503E122896AAEC18FC2692EE13FF792D637E4C8978823FFD318E070CF3513B54669A D54EF6F61ECF2F7BDB2DAB3A1D8B49DACEAD02A9566071A682DF29C72F46D1645D606EB82F54962D0FA905CE000FB8024C0655E613349D9374A21EB13080010 240C77702A4E4BFAEE0DDE726A673BDD7E7AE8F015BFC0D65D932843E54230968FA67F0C31E32A409F89BE7C7E8845020F6AE5C375A2D6E2B0750B9260AB278 127BC940E00DD6915F34899580841E008EA7E868740F70B263D69251B40899DBFD715851B5FED548C7E8DEB2FDCA3576142D66B2278E5857BB0FD25A49CC5E6 14D1DC591C7A80FE30E2D7FC2BD47B05D6357C0790F763BA177B9CB0FD2C0F61264B301DC7F43760E125FDDCCC7C01243D40CF2EF34B207AC6F603DA8B551595 A6E43D50F60F50E75BEA7355E8B9D1A8C8A3B635758CB25F647487950766A3B8567F867A684CFF6D5633C21C0D353C4F8888DF486985663AD5AB991059D7B34 AA0252E2BA494855F2470BBB3B63352309C7977CAD6B0D24CB1C2FCC32AD6E0AEA53BA5D76A6D0269FFA4F74683A43C87A0761F879BED0C124E23466B7B999 75696A4BF0E51D6D3C849B97574F9FE6DAA331EA4EC5B1A9DF8C10E6000D9238A17ACE7BB0CDBD0CF81B63B92947E1B81B214C684CE9915DBBF7C585E978D65");

    assert(element_cmp(c, d) == 0);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_pow(b, a, exp);
    }
    t2 = rdtsc();

    printf("element pow with torsion: %.2lf [clock]\n", (double)(t2 - t1) / N);

    mpz_set(exp, f->order);

    for (i = 0; i < 10; i++)
    {
        element_random(a);

        element_pow(b, a, exp);

        assert(element_cmp(b, a) == 0);
    }

    t1 = rdtsc();
    for (i = 0; i < M; i++) {
        element_pow(b, a, exp);
    }
    t2 = rdtsc();

    printf("element pow with order: %.2lf [clock]\n", (double)(t2 - t1) / M);

    mpz_clear(exp);

    //--------------------
    //  clear
    //--------------------
    element_clear(a);
    element_clear(b);
    element_clear(c);
    element_clear(d);

    element_clear(d1);
    element_clear(d2);

    element_clear(g1);
    element_clear(g2);
    element_clear(g3);
    element_clear(h1);
    element_clear(h2);
    element_clear(h3);
}

// //============================================
// //   test for sqrt
// //============================================
// void test_sqrt(Field f)
// {
//     int i;
//     unsigned long long int t1, t2;
//     Element a, b, c, d;
//
//     element_init(a, f);
//     element_init(b, f);
//     element_init(c, f);
//     element_init(d, f);
//
//     for (i = 0; i < 10; i++)
//     {
//         element_random(a);
//         element_sqr(b, a);
//
//         assert(element_is_sqr(b));
//
//         element_sqrt(c, b);
//         element_sqr(d, c);
//
//         assert(element_cmp(d, b) == 0);
//     }
//
//     t1 = rdtsc();
//     for (i = 0; i < N; i++) {
//         element_is_sqr(b);
//     }
//     t2 = rdtsc();
//
//     printf("element is sqr: %.2lf [clock]\n", (double)(t2 - t1) / N);
//
//     t1 = rdtsc();
//     for (i = 0; i < M; i++) {
//         element_sqrt(c, b);
//     }
//     t2 = rdtsc();
//
//     printf("element sqrt: %.2lf [clock]\n", (double)(t2 - t1) / M);
//
//     element_clear(a);
//     element_clear(b);
//     element_clear(c);
//     element_clear(d);
// }
//
// //============================================
// //   Frobenius Map \phi_p
// //============================================
// void test_frob(Field f)
// {
//     int i;
//     unsigned long long int t1, t2;
//     mpz_t p, p2, p3;
//     Element a, b, c;
//
//     mpz_init(p);
//     mpz_init(p2);
//     mpz_init(p3);
//
//     mpz_set(p, *field_get_char(f));
//     mpz_mul(p2, p, p);
//     mpz_mul(p3, p2, p);
//
//     element_init(a, f);
//     element_init(b, f);
//     element_init(c, f);
//
//     for (i = 0; i < 100; i++)
//     {
//         element_random(a);
//         element_pow(b, a, p);
//         bls509_fp12_frob_p(c, a);
//
//         assert(element_cmp(b, c) == 0);
//     }
//
//     t1 = rdtsc();
//     for (i = 0; i < N; i++) {
//         bls509_fp12_frob_p(c, a);
//     }
//     t2 = rdtsc();
//
//     printf("element frob p: %.2lf [clock]\n", (double)(t2 - t1) / N);
//
//     for (i = 0; i < 100; i++)
//     {
//         element_random(a);
//         element_pow(b, a, p2);
//         bls509_fp12_frob_p2(c, a);
//
//         assert(element_cmp(b, c) == 0);
//     }
//
//     t1 = rdtsc();
//     for (i = 0; i < N; i++) {
//         bls509_fp12_frob_p2(c, a);
//     }
//     t2 = rdtsc();
//
//     printf("element frob p2: %.2lf [clock]\n", (double)(t2 - t1) / N);
//
//     for (i = 0; i < 100; i++)
//     {
//         element_random(a);
//         element_pow(b, a, p3);
//         bls509_fp12_frob_p3(c, a);
//
//         assert(element_cmp(b, c) == 0);
//     }
//
//     t1 = rdtsc();
//     for (i = 0; i < N; i++) {
//         bls509_fp12_frob_p3(c, a);
//     }
//     t2 = rdtsc();
//
//     printf("element frob p3: %.2lf [clock]\n", (double)(t2 - t1) / N);
//
//     mpz_clear(p);
//     mpz_clear(p2);
//     mpz_clear(p3);
//
//     element_clear(a);
//     element_clear(b);
//     element_clear(c);
// }

//============================================
//   i/o test
//============================================
void test_io(Field f)
{
    int i;
    unsigned long long int t1, t2;
    char a_str[3120];

    size_t blen;
    unsigned char b_str[1536];

    Element a, b, c;

    element_init(a, f);
    element_init(b, f);
    element_init(c, f);

    for (i = 0; i < 100; i++)
    {
        element_random(a);

        element_get_str(a_str, a);
        element_set_str(c, a_str);

        assert(element_cmp(a, c) == 0);
    }

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_get_str(a_str, a);
    }
    t2 = rdtsc();

    printf("element get string: %.2lf [clock]\n", (double)(t2 - t1) / N);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_set_str(c, a_str);
    }
    t2 = rdtsc();

    printf("element set string: %.2lf [clock]\n", (double)(t2 - t1) / N);

    for (i = 0; i < 100; i++)
    {
        element_random(b);

        element_to_oct(b_str, &blen, b);
        element_from_oct(c, b_str, blen);

        assert(element_cmp(b, c) == 0);
    }

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_to_oct(b_str, &blen, b);
    }
    t2 = rdtsc();

    printf("element to octet string: %.2lf [clock]\n", (double)(t2 - t1) / N);

    t1 = rdtsc();
    for (i = 0; i < N; i++) {
        element_from_oct(c, b_str, blen);
    }
    t2 = rdtsc();

    printf("element from octet string: %.2lf [clock]\n", (double)(t2 - t1) / N);

    element_clear(a);
    element_clear(b);
    element_clear(c);
}

//============================================
//  main program
//============================================
int main(void)
{
    Field f;

    // test for methods
    field_init(f, "bls509_fp24");
    test_feature(f);
    test_arithmetic_operation(f);
    // test_sqrt(f);
    // test_frob(f);
    test_io(f);

    field_clear(f);

    fprintf(stderr, "ok\n");

    return 0;
}
